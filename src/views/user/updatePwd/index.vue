<template>
  <div class="box">
    <dir class="form-box">
      <!-- 旧密码 -->
      <div class="input-box">
        <svg t="1561948837248" class="icon svg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6904" width="200" height="200"><path d="M795.753087 396.817678l-29.925566 0L765.827521 279.989879c0-140.375098-99.423407-250.359025-240.645802-250.359025-141.772934 0-238.402715 112.313995-238.402715 250.359025l0 116.827799-29.936823 0c-66.042135 0-119.746268 54.846142-119.746268 122.372072l0 367.089609c0 67.50137 53.703109 122.394584 119.746268 122.394584l538.910906 0c66.067718 0 119.771851-54.894238 119.771851-122.394584L915.524938 519.189749C915.524938 451.662797 861.819782 396.817678 795.753087 396.817678L795.753087 396.817678zM346.64037 279.989879c0-104.244202 69.78232-189.161221 178.541349-189.161221 107.631346 0 180.7609 83.101673 180.7609 189.161221l0 116.827799L346.64037 396.817678 346.64037 279.989879 346.64037 279.989879zM855.614453 886.279359c0 33.750685-26.845415 61.198827-59.861366 61.198827L256.842181 947.478186c-33.026184 0-59.884902-27.447119-59.884902-61.198827L196.957279 519.189749c0-33.727149 26.857694-61.173245 59.884902-61.173245l538.910906 0c33.015951 0 59.861366 27.446096 59.861366 61.173245L855.614453 886.279359 855.614453 886.279359zM526.298146 580.313875c-33.05279 0-59.862389 27.471678-59.862389 61.245899 0 22.665209 12.043291 42.409902 29.9358 52.981678l0 100.001575c0 16.875343 13.405311 30.562063 29.92659 30.562063 16.542768 0 29.936823-13.68672 29.936823-30.562063L556.234969 694.541453c17.879206-10.571776 29.949103-30.316469 29.949103-52.981678C586.184071 607.785553 559.362192 580.313875 526.298146 580.313875L526.298146 580.313875 526.298146 580.313875z" p-id="6905" fill="#FA7133"></path></svg>
        <rg-input class="left20" ref="oldPwd" type="password" v-model="oldPwd" :max="18" :min="6" placeholder="请输入原密码" :is-type="$valid.pwd">
        </rg-input>
      </div>
      <!-- 新密码 -->
      <div class="input-box">
        <svg t="1561948837248" class="icon svg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6904" width="200" height="200"><path d="M795.753087 396.817678l-29.925566 0L765.827521 279.989879c0-140.375098-99.423407-250.359025-240.645802-250.359025-141.772934 0-238.402715 112.313995-238.402715 250.359025l0 116.827799-29.936823 0c-66.042135 0-119.746268 54.846142-119.746268 122.372072l0 367.089609c0 67.50137 53.703109 122.394584 119.746268 122.394584l538.910906 0c66.067718 0 119.771851-54.894238 119.771851-122.394584L915.524938 519.189749C915.524938 451.662797 861.819782 396.817678 795.753087 396.817678L795.753087 396.817678zM346.64037 279.989879c0-104.244202 69.78232-189.161221 178.541349-189.161221 107.631346 0 180.7609 83.101673 180.7609 189.161221l0 116.827799L346.64037 396.817678 346.64037 279.989879 346.64037 279.989879zM855.614453 886.279359c0 33.750685-26.845415 61.198827-59.861366 61.198827L256.842181 947.478186c-33.026184 0-59.884902-27.447119-59.884902-61.198827L196.957279 519.189749c0-33.727149 26.857694-61.173245 59.884902-61.173245l538.910906 0c33.015951 0 59.861366 27.446096 59.861366 61.173245L855.614453 886.279359 855.614453 886.279359zM526.298146 580.313875c-33.05279 0-59.862389 27.471678-59.862389 61.245899 0 22.665209 12.043291 42.409902 29.9358 52.981678l0 100.001575c0 16.875343 13.405311 30.562063 29.92659 30.562063 16.542768 0 29.936823-13.68672 29.936823-30.562063L556.234969 694.541453c17.879206-10.571776 29.949103-30.316469 29.949103-52.981678C586.184071 607.785553 559.362192 580.313875 526.298146 580.313875L526.298146 580.313875 526.298146 580.313875z" p-id="6905" fill="#FA7133"></path></svg>
        <rg-input class="left20" ref="pwd" type="password" v-model="pwd" :max="18" :min="6" placeholder="请输入新密码" :is-type="$valid.pwd">
        </rg-input>
      </div>
      <!-- 确认新密码 -->
      <div class="input-box">
        <svg t="1561948154378" class="icon svg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5238" width="200" height="200"><path d="M918.09 267.683c-36.098-2.493-72.38-9.274-103.495-19.238-10.076-3.03-20.161-6.388-30.307-10.02-21.385-6.3-50.481-18.793-83.506-36.593-0.354-0.162-0.704-0.364-1.053-0.553a758.213 758.213 0 0 1-23.794-13.412c-10.899-6.243-21.69-12.903-32.463-19.843-0.417-0.282-0.83-0.533-1.237-0.807a736.62 736.62 0 0 1-23.093-15.518c-4.976-3.414-9.96-7.052-14.945-10.66-3.749-2.748-7.497-5.33-11.248-8.165-27.428-20.486-54.5-43.47-79.85-68.233-25.35 24.762-52.426 47.747-79.854 68.233-3.744 2.834-7.498 5.417-11.246 8.165-4.991 3.608-9.97 7.246-14.945 10.66a740.312 740.312 0 0 1-23.095 15.518c-0.405 0.274-0.825 0.525-1.232 0.807-10.78 6.94-21.564 13.6-32.465 19.843a759.218 759.218 0 0 1-23.798 13.412c-0.346 0.187-0.704 0.39-1.046 0.553-33.026 17.8-62.128 30.293-83.516 36.592-10.138 3.638-20.216 6.992-30.302 10.021-31.118 9.964-67.39 16.745-103.496 19.238h-0.087c1.053 16.181 2.139 37.645 3.404 60.882 0.2 0 0.435 0 0.669-0.036 6.092 86.729 23.472 210.094 49.695 282.578 1.174 3.166 2.172 6.472 3.347 9.606 0.55 1.474 1.196 2.838 1.75 4.303 62.764 162.038 171.777 279.94 302.787 323.156v0.45c17.316 5.716 31.906 9.25 43.426 11.467 11.518-2.223 26.116-5.75 43.432-11.467v-0.45c131.012-43.215 240.018-161.118 302.788-323.156 0.555-1.476 1.199-2.83 1.757-4.303 1.167-3.134 2.169-6.44 3.34-9.606 26.227-72.485 43.606-195.85 49.7-282.578 0.237 0.034 0.474 0.034 0.67 0.034 1.262-23.235 2.343-44.697 3.398-60.88h-0.09z m-47.356 41.892l-0.51 9.497a40.555 40.555 0 0 0-1.02 6.623c-5.675 80.73-21.61 200.398-47.277 271.337-0.71 1.92-1.376 3.885-2.035 5.847-0.411 1.222-0.816 2.45-1.446 4.049a88.11 88.11 0 0 0-1.383 3.396c-58.358 150.646-158.712 259.11-275.335 297.58a45.262 45.262 0 0 0-5.458 2.2c-7.916 2.473-15.666 4.582-23.178 6.303-7.461-1.71-15.18-3.811-23.078-6.273a45.728 45.728 0 0 0-5.544-2.231C367.84 869.435 267.49 760.97 209.244 610.6c-0.459-1.207-0.94-2.377-1.693-4.148-0.443-1.179-0.84-2.394-1.251-3.61-0.664-1.964-1.333-3.932-1.934-5.56-25.76-71.2-41.695-190.87-47.365-271.583a40.1 40.1 0 0 0-1.028-6.644l-0.497-9.297-0.236-4.446c24.621-3.806 48.37-9.301 69.956-16.219 10.13-3.045 20.419-6.435 31.414-10.354 25.206-7.576 56.438-21.22 90.48-39.532 0.59-0.303 1.154-0.604 1.654-0.878a792.319 792.319 0 0 0 24.809-13.975c10.71-6.133 21.986-13.024 34.475-21.065 0.35-0.224 0.953-0.612 1.297-0.846 8.204-5.301 16.375-10.777 24.12-16.205 4.546-3.115 9.094-6.403 13.65-9.7l2.444-1.77 4.041-2.912c2.582-1.847 5.163-3.7 7.536-5.495a850.42 850.42 0 0 0 51.985-42.12 845.427 845.427 0 0 0 51.798 41.98c2.565 1.937 5.128 3.777 7.691 5.61l4.277 3.086 1.553 1.125c4.779 3.463 9.56 6.924 13.95 9.929a743.982 743.982 0 0 0 23.73 15.962l2.06 1.346c12.386 7.98 23.664 14.875 34.072 20.836a806.06 806.06 0 0 0 25.016 14.104c0.399 0.217 0.95 0.507 1.535 0.808 34.167 18.404 65.523 32.114 90.813 39.72 11.015 3.92 21.271 7.3 30.587 10.091 22.118 7.084 46.069 12.642 70.782 16.47l-0.23 4.267z m-159.473 102.08L476.928 651.833l-119.96-122.965c-8.311-8.516-21.773-8.516-30.084 0-8.311 8.523-8.311 22.32 0 30.84l135.003 138.378c4.155 4.26 9.597 6.39 15.041 6.39 5.444 0 10.887-2.13 15.04-6.39l249.375-255.592c8.312-8.516 8.312-22.316 0-30.837-8.309-8.518-21.771-8.518-30.082 0z" p-id="5239" fill="#FA7133"></path></svg>
        <rg-input class="left20" ref="rePwd" type="password" v-model="rePwd" :max="18" :min="6" placeholder="确认新密码" :is-type="$valid.pwd">
        </rg-input>
      </div>
    </dir>
    <!-- <btn type="primary" style="width: 96%" @click.native="onClickCommit">{{$t("user.commit")}}</btn> -->
    <button class="con" style="width: 96%" @click="onClickCommit">{{$t("user.commit")}}</button>
  </div>
</template>

<script>
import { mapActions } from "vuex";
import Input from "@/components/input/index.vue";
export default {
  name: "updatePwd",
  components: {
    rgInput: Input
  },
  data() {
    return {
      oldPwd: "",
      pwd: "",
      rePwd: "",
    };
  },
  methods: {
    ...mapActions({ updatePwd: "user/updatePwd" }),
    onClickCommit() {
      let $refs = this.$refs;
      if (!$refs.oldPwd.valid) {
        this.$toast.show(this.$t('user.pwdError'));
        return;
      }
      if (!$refs.pwd.valid) {
        this.$toast.show(this.$t('user.pwdError'));
        return;
      }
      if (this.rePwd.valid) {
        this.$toast.show(this.$t('user.pwdError'));
        return;
      }
      if (this.pwd !== this.rePwd) {
        this.$toast.show("两次新密码输入不一致");
        return;
      }
      this.updatePwd({
        oldPwd: this.oldPwd,//旧密码
        newPwd: this.pwd,//新密码
        pwd: this.rePwd//确认新密码
      }).then(() => {
        this.$router.replace({
          name: "login",
          query: {
            account: this.account
          }
        })
      }, error => {
        console.log("error", error)
      })

    }
  }
};
</script>
<style lang="stylus" scoped>
.box
  background-color #EEEEEE
  height 100%
.form-box
  padding 24px 8px
  margin 0
  height 2rem
.input-box
  display flex
  border 1px solid #D2D2D2
  border-radius 5px
  margin-bottom 16px
  border none
  background-color #FFFFFF
.form-icon
  width 20px
  margin-right 10px
  color #4B79D4
.con
  border none
  position relative
  display block;
  margin-left: auto
  margin-right auto
  padding-left 14px
  padding-right 14px
  -webkit-box-sizing border-box
  box-sizing border-box
  font-size 18px
  text-align center
  text-decoration none
  color #ffffff
  line-height 2.33333333
  border-radius 5px
  -webkit-tap-highlight-color rgba(0, 0, 0, 0)
  overflow: hidden
  background-color #F8AD8C
.svg
  height 20px
  width 20px 
  margin 12px 13px 0
.left20
  margin-left -20px
</style>
